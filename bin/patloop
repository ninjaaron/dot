#!/data/data/com.termux/files/usr/bin/env python3

import re, os, sys
import subprocess as sp

cmd, pat, repl = sys.argv[1:]
pat = re.compile(pat)
repl = eval(repl) if repl.startswith('lambda') else repl

filenames = (f for f in os.listdir() if pat.search(f))

for name in filenames:
    newname = pat.sub(repl, name)
    print(name, ' -> ', newname)
    sp.run([cmd, name, newname])
