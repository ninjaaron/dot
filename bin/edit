#!/usr/bin/env bash

if [[ -e $1 ]]; then
  list=($(ls -ld "$1"))
else
  if [[ ${1%/*} == $1 ]]; then
    list=($(ls -ld .))
  else
    list=($(ls -ld "${1%/*}"))
  fi
fi

perm=${list[0]}
owner=${list[2]}
group=${list[3]}

for i in $(groups); do
  if [[ $i == $group ]] && [[ ${perm:5:1} == 'w' ]] ||
  [[ ${perm:8:1} == 'w' ]]; then
    writable=true
    break
  fi
done

if [[ $owner == $USER ]] || [[ $writable == true ]]; then
  $EDITOR $@
else
  echo -n "sudo [Y/n]? "
  read sudo
  [[ ${sudo:-y} == y ]] && sudo $EDITOR $@ || $EDITOR $@
fi
